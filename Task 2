{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "8d8e90ed-0975-43de-944d-c24dd44e45f8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "This chart is accessible only between 1 PM and 2 PM IST.\n"
     ]
    }
   ],
   "source": [
    "def free_vs_paid_chart():\n",
    "    import pandas as pd\n",
    "    import matplotlib.pyplot as plt\n",
    "    import numpy as np\n",
    "    from datetime import datetime\n",
    "    import pytz\n",
    "\n",
    "    # Time restriction\n",
    "    ist = pytz.timezone(\"Asia/Kolkata\")\n",
    "    current_time = datetime.now(ist)\n",
    "\n",
    "    if not (13 <= current_time.hour < 14):\n",
    "        print(\"This chart is accessible only between 1 PM and 2 PM IST.\")\n",
    "        return\n",
    "\n",
    "    # Load Dataset\n",
    "    file_path = r\"C:\\Users\\user\\OneDrive\\Desktop\\Null Class\\Google Playstore Apps.csv\"\n",
    "    data = pd.read_csv(file_path)\n",
    "\n",
    "    # Data Cleaning\n",
    "    data[\"Installs\"] = (\n",
    "        data[\"Installs\"].astype(str)\n",
    "        .str.replace(\",\", \"\", regex=False)\n",
    "        .str.replace(\"+\", \"\", regex=False)\n",
    "    )\n",
    "    data[\"Installs\"] = pd.to_numeric(data[\"Installs\"], errors=\"coerce\")\n",
    "\n",
    "    data[\"Price\"] = data[\"Price\"].astype(str).str.replace(\"$\", \"\", regex=False)\n",
    "    data[\"Price\"] = pd.to_numeric(data[\"Price\"], errors=\"coerce\")\n",
    "\n",
    "    data[\"Revenue\"] = data[\"Price\"] * data[\"Installs\"]\n",
    "\n",
    "    data[\"Android_Num\"] = data[\"Android Ver\"].astype(str).str.extract(r\"(\\d+\\.\\d+)\")[0]\n",
    "    data[\"Android_Num\"] = pd.to_numeric(data[\"Android_Num\"], errors=\"coerce\")\n",
    "\n",
    "    data[\"Name_Length\"] = data[\"App\"].astype(str).apply(len)\n",
    "\n",
    "    # Apply Filters\n",
    "    filtered = data[\n",
    "        (data[\"Installs\"] >= 10000) &\n",
    "        (data[\"Revenue\"] >= 10000) &\n",
    "        (data[\"Android_Num\"] > 4.0) &\n",
    "        (data[\"Name_Length\"] <= 30)\n",
    "    ]\n",
    "\n",
    "    if filtered.empty:\n",
    "        print(\"No data available after applying filters.\")\n",
    "        return\n",
    "\n",
    "    top3 = (\n",
    "        filtered.groupby(\"Category\")[\"Installs\"]\n",
    "        .sum()\n",
    "        .sort_values(ascending=False)\n",
    "        .head(3)\n",
    "        .index\n",
    "    )\n",
    "\n",
    "    final_df = filtered[filtered[\"Category\"].isin(top3)]\n",
    "\n",
    "    summary = final_df.groupby(\"Type\").agg(\n",
    "        Avg_Installs=(\"Installs\", \"mean\"),\n",
    "        Avg_Revenue=(\"Revenue\", \"mean\")\n",
    "    )\n",
    "\n",
    "    summary = summary.loc[summary.index.isin([\"Free\", \"Paid\"])]\n",
    "\n",
    "    if summary.empty:\n",
    "        print(\"No Free or Paid apps match the criteria.\")\n",
    "        return\n",
    "\n",
    "    # Plot\n",
    "    fig, ax1 = plt.subplots(figsize=(11, 6))\n",
    "    x = np.arange(len(summary.index))\n",
    "\n",
    "    ax1.bar(x, summary[\"Avg_Installs\"], width=0.45)\n",
    "    ax1.set_ylabel(\"Average Installs\")\n",
    "    ax1.set_xticks(x)\n",
    "    ax1.set_xticklabels(summary.index)\n",
    "    ax1.set_xlabel(\"App Type\")\n",
    "\n",
    "    ax2 = ax1.twinx()\n",
    "    ax2.plot(x, summary[\"Avg_Revenue\"], marker=\"o\", linestyle=\"--\")\n",
    "    ax2.set_ylabel(\"Average Revenue ($)\")\n",
    "\n",
    "    ax1.grid(axis='y', linestyle='--', alpha=0.4)\n",
    "\n",
    "    plt.title(\n",
    "        \"Free vs Paid Apps Performance\\n\"\n",
    "        \"Average Installs and Revenue (Top 3 Categories)\"\n",
    "    )\n",
    "\n",
    "    plt.tight_layout()\n",
    "    plt.show()\n",
    "\n",
    "free_vs_paid_chart()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "68756767-673e-4ecf-90c4-b74c176965b5",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.14.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
fig2.write_html("dashboard_html/Type_Graph_2.html") 
