<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Play Store Analytics</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { text-align: center; color: #333; }
        .chart-container { width: 90%; margin: 40px auto; }
    </style>
</head>
<body>
    <h1>Google Play Store Analytics Dashboard</h1>

    <div class="chart-container">
        <h2>Number of Apps by Category</h2>
        <div id="categoryChart" style="width:100%; height:500px;"></div>
    </div>

    <div class="chart-container">
        <h2>Free vs Paid Apps</h2>
        <div id="typeChart" style="width:100%; height:500px;"></div>
    </div>

    <div class="chart-container">
        <h2>Average Rating by Category</h2>
        <div id="ratingChart" style="width:100%; height:500px;"></div>
    </div>

    <div class="chart-container">
        <h2>Top 20 Apps by Reviews</h2>
        <div id="reviewsChart" style="width:100%; height:500px;"></div>
    </div>

    <script>
        Plotly.d3.csv("Google Playstore Apps.csv", function(err, rows) {
            if(err) { console.error("Error loading CSV:", err); return; }

            // ----- Category Count -----
            var categoryCounts = {};
            rows.forEach(r => { categoryCounts[r.Category] = (categoryCounts[r.Category]||0) + 1; });
            var categories = Object.keys(categoryCounts);
            var counts = Object.values(categoryCounts);

            Plotly.newPlot('categoryChart', [{
                x: categories,
                y: counts,
                type: 'bar',
                marker: {color: 'rgb(100,200,255)'}
            }], {
                xaxis:{title:'Category'}, yaxis:{title:'Number of Apps'}
            });

            // ----- Free vs Paid -----
            var typeCounts = {Free:0, Paid:0};
            rows.forEach(r => { typeCounts[r.Type] = (typeCounts[r.Type]||0)+1; });
            Plotly.newPlot('typeChart', [{
                labels: Object.keys(typeCounts),
                values: Object.values(typeCounts),
                type: 'pie'
            }], {
                showlegend:true
            });

            // ----- Average Rating by Category -----
            var ratingSums = {}, ratingCounts = {};
            rows.forEach(r=>{
                var cat = r.Category, rating = parseFloat(r.Rating);
                if(!isNaN(rating)){
                    ratingSums[cat] = (ratingSums[cat]||0) + rating;
                    ratingCounts[cat] = (ratingCounts[cat]||0) + 1;
                }
            });
            var avgRatings = categories.map(c => ratingSums[c]/ratingCounts[c]);
            Plotly.newPlot('ratingChart', [{
                x: categories,
                y: avgRatings,
                type: 'bar',
                marker:{color:'rgb(255,165,0)'}
            }], {
                xaxis:{title:'Category'}, yaxis:{title:'Average Rating'}
            });

            // ----- Top 20 Apps by Reviews -----
            var appsWithReviews = rows.map(r=>({app:r.App, reviews:parseInt(r.Reviews.replace(/,/g,''))||0}));
            appsWithReviews.sort((a,b)=>b.reviews - a.reviews);
            var topApps = appsWithReviews.slice(0,20);
            Plotly.newPlot('reviewsChart', [{
                x: topApps.map(a=>a.app),
                y: topApps.map(a=>a.reviews),
                type:'bar',
                marker:{color:'rgb(150,50,200)'}
            }], {
                xaxis:{title:'App', tickangle:-45}, yaxis:{title:'Number of Reviews'}
            });
        });
    </script>
</body>
</html>
